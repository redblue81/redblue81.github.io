<!DOCTYPE html>

<html>

<head>

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Gestione dei permessi delle app in Android 6 Marshmallow | RedBlue’s Blog</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Gestione dei permessi delle app in Android 6 Marshmallow" />
<meta name="author" content="RedBlue" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In Android 6 una delle innovazioni pi&ugrave; rilevanti (anche a livello di sviluppo) &egrave; la gestione dei permessi delle app. Avete presente? Parliamo di quella lista di autorizzazioni (accesso ai contatti, alla fotocamera, alla rete, allo storage, etc) che quasi ogni app presentava in fase di installazione, e che bisognava accettare per proseguire l&#39;installazione stessa (a dire il vero, tale lista nella maggior parte dei casi veniva completamente ignorata). Adesso la musica &egrave; cambiata, non c&#39;&egrave; pi&ugrave; il listone di permessi in fase di installazione, ma l&#39;app dovr&agrave; presentare all&#39;utente la richiesta di accedere ad una determinata funzionalit&agrave; solo quando questa si render&agrave; necessaria (ovvero a runtime). L&#39;utente pu&ograve; decidere se concedere l&#39;autorizzazione (in tal caso non ci sar&agrave; pi&ugrave; alcuna richiesta per quella caratteristica) oppure no. Inoltre, nelle impostazioni dell&#39;app, c&#39;&egrave; la lista dei permessi concessi, con la possibilit&agrave; di revocarli. Dal punto di vista dello sviluppatore, questo comporta un&#39;aggiunta di codice, necessaria ad implementare questa nuova gestione. Ovviamente, i permessi necessari vanno sempre dichiarati nell&#39;AndroidManifest.xml, ad esempio, considerando i servizi di localizzazione, dovremo aggiungere la riga: A questo punto, nell&#39;activity che stiamo realizzando, sar&agrave; necessario gestire la richiesta, potremmo ad esempio usare del codice simile a questo: if (Build.VERSION.SDK_INT &gt;= 23 &amp;&amp;" />
<meta property="og:description" content="In Android 6 una delle innovazioni pi&ugrave; rilevanti (anche a livello di sviluppo) &egrave; la gestione dei permessi delle app. Avete presente? Parliamo di quella lista di autorizzazioni (accesso ai contatti, alla fotocamera, alla rete, allo storage, etc) che quasi ogni app presentava in fase di installazione, e che bisognava accettare per proseguire l&#39;installazione stessa (a dire il vero, tale lista nella maggior parte dei casi veniva completamente ignorata). Adesso la musica &egrave; cambiata, non c&#39;&egrave; pi&ugrave; il listone di permessi in fase di installazione, ma l&#39;app dovr&agrave; presentare all&#39;utente la richiesta di accedere ad una determinata funzionalit&agrave; solo quando questa si render&agrave; necessaria (ovvero a runtime). L&#39;utente pu&ograve; decidere se concedere l&#39;autorizzazione (in tal caso non ci sar&agrave; pi&ugrave; alcuna richiesta per quella caratteristica) oppure no. Inoltre, nelle impostazioni dell&#39;app, c&#39;&egrave; la lista dei permessi concessi, con la possibilit&agrave; di revocarli. Dal punto di vista dello sviluppatore, questo comporta un&#39;aggiunta di codice, necessaria ad implementare questa nuova gestione. Ovviamente, i permessi necessari vanno sempre dichiarati nell&#39;AndroidManifest.xml, ad esempio, considerando i servizi di localizzazione, dovremo aggiungere la riga: A questo punto, nell&#39;activity che stiamo realizzando, sar&agrave; necessario gestire la richiesta, potremmo ad esempio usare del codice simile a questo: if (Build.VERSION.SDK_INT &gt;= 23 &amp;&amp;" />
<link rel="canonical" href="https://red-blue.it/tipsntricks/in%20evidenza/android/programmazione/2016/02/06/gestione-dei-permessi-delle-app-in-android-6-marshmallow.html" />
<meta property="og:url" content="https://red-blue.it/tipsntricks/in%20evidenza/android/programmazione/2016/02/06/gestione-dei-permessi-delle-app-in-android-6-marshmallow.html" />
<meta property="og:site_name" content="RedBlue’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-02-06T11:56:23+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Gestione dei permessi delle app in Android 6 Marshmallow" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"RedBlue"},"dateModified":"2016-02-06T11:56:23+00:00","datePublished":"2016-02-06T11:56:23+00:00","description":"In Android 6 una delle innovazioni pi&ugrave; rilevanti (anche a livello di sviluppo) &egrave; la gestione dei permessi delle app. Avete presente? Parliamo di quella lista di autorizzazioni (accesso ai contatti, alla fotocamera, alla rete, allo storage, etc) che quasi ogni app presentava in fase di installazione, e che bisognava accettare per proseguire l&#39;installazione stessa (a dire il vero, tale lista nella maggior parte dei casi veniva completamente ignorata). Adesso la musica &egrave; cambiata, non c&#39;&egrave; pi&ugrave; il listone di permessi in fase di installazione, ma l&#39;app dovr&agrave; presentare all&#39;utente la richiesta di accedere ad una determinata funzionalit&agrave; solo quando questa si render&agrave; necessaria (ovvero a runtime). L&#39;utente pu&ograve; decidere se concedere l&#39;autorizzazione (in tal caso non ci sar&agrave; pi&ugrave; alcuna richiesta per quella caratteristica) oppure no. Inoltre, nelle impostazioni dell&#39;app, c&#39;&egrave; la lista dei permessi concessi, con la possibilit&agrave; di revocarli. Dal punto di vista dello sviluppatore, questo comporta un&#39;aggiunta di codice, necessaria ad implementare questa nuova gestione. Ovviamente, i permessi necessari vanno sempre dichiarati nell&#39;AndroidManifest.xml, ad esempio, considerando i servizi di localizzazione, dovremo aggiungere la riga: A questo punto, nell&#39;activity che stiamo realizzando, sar&agrave; necessario gestire la richiesta, potremmo ad esempio usare del codice simile a questo: if (Build.VERSION.SDK_INT &gt;= 23 &amp;&amp;","headline":"Gestione dei permessi delle app in Android 6 Marshmallow","mainEntityOfPage":{"@type":"WebPage","@id":"https://red-blue.it/tipsntricks/in%20evidenza/android/programmazione/2016/02/06/gestione-dei-permessi-delle-app-in-android-6-marshmallow.html"},"url":"https://red-blue.it/tipsntricks/in%20evidenza/android/programmazione/2016/02/06/gestione-dei-permessi-delle-app-in-android-6-marshmallow.html"}</script>
<!-- End Jekyll SEO tag -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>
    Gestione dei permessi delle app in Android 6 Marshmallow - RedBlue&#39;s Blog
    
  </title>

  <meta name="description" content="In Android 6 una delle innovazioni pi&amp;ugrave; rilevanti (anche a livello di sviluppo) &amp;egrave; la gestione dei permessi delle app. Avete presente? Parliamo d...">

  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://red-blue.it/tipsntricks/in%20evidenza/android/programmazione/2016/02/06/gestione-dei-permessi-delle-app-in-android-6-marshmallow.html">
  <link rel="alternate" type="application/rss+xml" title="RedBlue&#39;s Blog" href="/feed.xml">

</head> 

<body>

  <!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="/">RedBlue&#39;s Blog</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fa fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/about">About</a>
        </li>
		    <li class="nav-item">
          <a class="nav-link" href="/domotica">Domotica</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/posts">Posts</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/contact">Contacts</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

  <!-- Page Header -->

  <header class="masthead">
    
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <div class="post-heading">
            <h1>Gestione dei permessi delle app in Android 6 Marshmallow</h1>
            
            <span class="meta">Posted by
              <a href="#">RedBlue</a>
              on February 06, 2016 &middot; <span class="reading-time" title="Estimated read time">
  
   4 mins  read </span>

            </span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">

        <p>In <strong>Android 6</strong> una delle innovazioni pi&ugrave; rilevanti (anche a livello di <strong>sviluppo</strong>) &egrave; la <strong>gestione dei permessi delle app</strong>. Avete presente? Parliamo di quella <strong>lista di autorizzazioni</strong> (accesso ai contatti, alla fotocamera, alla rete, allo storage, etc) che quasi ogni app presentava in fase di installazione, e che bisognava accettare per proseguire l'installazione stessa (a dire il vero, tale lista nella maggior parte dei casi veniva completamente ignorata).</p>
<p><a href="/assets/images/Android.jpg" rel="attachment wp-att-3723"><img class="aligncenter wp-image-3723 size-medium" title="android" src="/assets/images/Android-300x225.jpg" alt="Android" width="300" height="225" /></a></p>
<p>Adesso la musica &egrave; cambiata, non c'&egrave; pi&ugrave; il listone di permessi in fase di installazione, ma l'app dovr&agrave; presentare all'utente la richiesta di accedere ad una determinata funzionalit&agrave; solo quando questa si render&agrave; necessaria (ovvero a <strong>runtime</strong>). L'utente pu&ograve; decidere se concedere l'autorizzazione (in tal caso non ci sar&agrave; pi&ugrave; alcuna richiesta per quella caratteristica) oppure no. Inoltre, nelle impostazioni dell'app, c'&egrave; la lista dei permessi concessi, con la possibilit&agrave; di <strong>revocarli</strong>.</p>
<p><!--moreContinua a leggere...--></p>
<p>Dal punto di vista dello <strong>sviluppatore</strong>, questo comporta un'aggiunta di codice, necessaria ad implementare questa nuova gestione. Ovviamente, i permessi necessari vanno sempre dichiarati nell'<strong>AndroidManifest.xml</strong>, ad esempio, considerando i servizi di <strong>localizzazione</strong>, dovremo aggiungere la riga:</p>
<pre class="brush: xml; gutter: false"><uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/></pre>
<p>A questo punto, nell'activity che stiamo realizzando, sar&agrave; necessario gestire la richiesta, potremmo ad esempio usare del codice simile a questo:</p>
<pre class="brush: java; gutter: true">if (Build.VERSION.SDK_INT >= 23 &&

                    ContextCompat.checkSelfPermission(getApplicationContext(), android.Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED {

                Log.i(TAG, "Verifica permessi per la localizzazione");

                requestLocationPermission();

            } else {

                Log.i(TAG, "Permessi di accesso alla localizzazione gi&agrave; concessi");

                accessMap();

            }

</pre>
<p>Come si vede, in caso di versione delle <strong>API</strong> a partire dalla <strong>23</strong> (Android M), verr&agrave; chiamato il metodo <strong>checkSelfPermission(context, permission)</strong> sul permesso in questione. I due metodi requestLocationPermission() e accessMap() sono semplicemente due implementazioni che ho realizzato per gestire la richiesta e per visualizzare la mappa (rispettivamente). Vediamo il primo:</p>
<pre class="brush: java; gutter: true">private void requestLocationPermission() {

        Log.i(TAG, "Richiesta permessi per la LOCALIZZAZIONE");

        if (ActivityCompat.shouldShowRequestPermissionRationale(this, android.Manifest.permission.ACCESS_FINE_LOCATION)) {

            Snackbar.make(mLayout, R.string.permission_location, Snackbar.LENGTH_INDEFINITE).setAction(R.string.permission_location_go, new View.OnClickListener() {

                @Override

                public void onClick(View v) {
&&
                    ActivityCompat.requestPermissions(MapTorneiActivity.this, new String[]{android.Manifest.permission.ACCESS_FINE_LOCATION}, REQUEST_LOCATION);

                }

            }).show();

        } else {

            ActivityCompat.requestPermissions(this, new String[]{android.Manifest.permission.ACCESS_FINE_LOCATION}, REQUEST_LOCATION);

        }

    }</pre>
<p>Questo metodo serve appunto a presentare all'utente la <strong>richiesta</strong> di accesso al sistema di localizzazione del terminale, permesso che l'utente potr&agrave; concedere o meno (ovviamente in quest'ultimo caso, la parte della nostra app che richiede l'uso della localizzazione non funzioner&agrave;).</p>
<p>Infine, &egrave; possibile anche sfruttare un metodo di <strong>callback</strong>, che eseguir&agrave; determinate operazioni in base alla risposta dell'utente:</p>
<pre class="brush: java; gutter: true">@Override

    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {

        Log.i(TAG, "Risposta dell\&#039;utente alla richiesta di accesso alla localizzazione");

        if (requestCode == REQUEST_LOCATION) {

            if (grantResults.length == 1 &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED) {

                Snackbar.make(mLayout, R.string.permission_location_ok, Snackbar.LENGTH_SHORT).show();

                accessMap();

            } else {

                Snackbar.make(mLayout, R.string.permission_location_no, Snackbar.LENGTH_SHORT).show();

            }

        } else {

            super.onRequestPermissionsResult(requestCode, permissions, grantResults);

        }

    }</pre>
<p>Con questo metodo, se l'utente concede l'autorizzazione, viene richiamato accessMap() che imposta e visualizza la mappa, altrimenti un messaggio avvisa che l'autorizzazione non &egrave; stata concessa (la mappa verr&agrave; ugualmente visualizzata, ma ovviamente non sar&agrave; visibile nulla di ci&ograve; che la nostra app dovrebbe fare.</p>
<p>L'implementazione del metodo accessMap() esula dall'argomento trattato in questo post, ma si tratta fondamentalmente di un metodo che gestisce le impostazioni di visualizzazione della mappa e attiva la ricerca della posizione del terminale.</p>
<p>In ultimo, se nell'app si trovano altre chiamate che potrebbero necessitare di permessi, per ognuna di essere va implementata una gestione simile a quella vista, o in alternativa si pu&ograve; scegliere di gestire per intero la chiamata "principale", andando a racchiudere in un blocco <strong>try.. catch</strong> le altre chiamate, in modo da poter almeno sollevare una <strong>SecurityException</strong> in caso di mancanza del relativo permesso. Resta inteso che se l'app mantiene una retrocompatibilit&agrave; con versioni precedenti di Android, la gestione dei permessi resta quella a cui eravamo abituati.</p>
<p>Alla prossima..</p>


        <hr>

        <div class="clearfix">

          
          <a class="btn btn-primary float-left" href="/taranto/in%20evidenza/eventi/2015/11/03/deploylab-vi-invita-a-scoprire-felfil-taranto-7112015.html" data-toggle="tooltip" data-placement="top" title="DeployLab vi invita a scoprire FelFil - Taranto 7/11/2015">&larr; Previous<span class="d-none d-md-inline">
              Post</span></a>
          
          
          <a class="btn btn-primary float-right" href="/taranto/in%20evidenza/eventi/2016/04/24/laboratorio-stampa-3d-dallidea-al-prototipo-stampato.html" data-toggle="tooltip" data-placement="top" title="L'associazione Deploy LAB presenta LABORATORIO DI STAMPA 3D: dall'idea al prototipo stampato">Next<span class="d-none d-md-inline">
              Post</span> &rarr;</a>
          

        </div>

      </div>
    </div>
  </div>


  <!-- Footer -->

<hr>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        <ul class="list-inline text-center">
          
          <li class="list-inline-item">
            <a href="mailto:redblue81@gmail.com">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="far fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://twitter.com/redblue81">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://www.facebook.com/angeloredbluepascadopoli">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-facebook-f fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://www.linkedin.com/in/angelopascadopoli">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://github.com/redblue81">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://instagram.com/redblue81">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-instagram fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="copyright text-muted">Copyright &copy; RedBlue 2025</p>
      </div>
    </div>
  </div>
</footer>

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/assets/vendor/startbootstrap-clean-blog/js/scripts.js"></script>

<script src="/assets/scripts.js"></script>




  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LVMQV0LE9M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LVMQV0LE9M');
</script>

</body>

</html>